#LyX 2.1 created this file. For more info see http://www.lyx.org/
\lyxformat 474
\begin_document
\begin_header
\textclass elsarticle
\begin_preamble


\setlength{\textwidth}{6.5in}
%\setlength{\textheight}{9in}
\setlength{\topmargin}{0in}
\setlength{\oddsidemargin}{0in}
\setlength{\evensidemargin}{0in}

\usepackage{amsthm}
\usepackage{mathabx}
\usepackage{bm}
\usepackage{multirow}
\usepackage{tabularx}
\newcolumntype{Y}{>{\centering\arraybackslash}X}

%\geometry{landscape}                % Activate for for rotated page geometry
\usepackage[parfill]{parskip}% Activate to begin paragraphs with an empty line rather than an indent
\usepackage{graphicx}
\usepackage{epstopdf}
\usepackage{verbatim}
\usepackage{longtable}
\usepackage{rotating}
\usepackage[nolists,nomarkers]{endfloat}
\DeclareDelayedFloatFlavour{sidewaystable}{table}

\usepackage{relsize}
%\usepackage{caption}
\usepackage{subcaption}
\usepackage{fullpage}
\usepackage{booktabs}





\DeclareGraphicsRule{.tif}{png}{.png}{`convert #1 `dirname #1`/`basename #1 .tif`.png}
\DeclareMathOperator*{\argmin}{\arg\!\min}
\DeclareMathOperator*{\argmax}{\arg\!\max}
\DeclareMathOperator*{\bw}{\mbox{bw}}
\DeclareMathOperator*{\df}{\mbox{df}}
\newcommand{\vect}[1]{\bm{#1}}
\newcommand{\E}{\mathop{\mathbb E}}



\newtheorem{theorem}{}[section]
\newtheorem{lemma}[theorem]{}\newtheorem{proposition}[theorem]{}\newtheorem{corollary}[theorem]{}



\title{Oracle properties of local adaptive grouped regularization}
\author{Wesley Brooks}
                                           % Activate to display a given date or no date
\end_preamble
\options authoryear,review
\use_default_options false
\maintain_unincluded_children false
\language english
\language_package none
\inputencoding auto
\fontencoding default
\font_roman default
\font_sans default
\font_typewriter default
\font_math auto
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100
\font_tt_scale 100
\graphics default
\default_output_format default
\output_sync 0
\bibtex_command default
\index_command default
\paperfontsize 11
\spacing other 2
\use_hyperref false
\papersize default
\use_geometry false
\use_package amsmath 2
\use_package amssymb 2
\use_package cancel 0
\use_package esint 1
\use_package mathdots 0
\use_package mathtools 0
\use_package mhchem 0
\use_package stackrel 0
\use_package stmaryrd 0
\use_package undertilde 0
\cite_engine natbib
\cite_engine_type authoryear
\biblio_style plainnat
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date true
\justification true
\use_refstyle 0
\index Index
\shortcut idx
\color #008000
\end_index
\secnumdepth 3
\tocdepth 3
\paragraph_separation indent
\paragraph_indentation default
\quotes_language english
\papercolumns 1
\papersides 1
\paperpagestyle default
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Section
Spatially varying coefficients regression 
\begin_inset CommandInset label
LatexCommand label
name "section:SVCR"

\end_inset


\end_layout

\begin_layout Subsection
Model
\end_layout

\begin_layout Standard
Consider 
\begin_inset Formula $n$
\end_inset

 data points, observed at sampling locations 
\begin_inset Formula $\bm{s}_{i}=(s_{i,1}\;\; s_{i,2})^{T}$
\end_inset

 for 
\begin_inset Formula $i=1,\dots,\bm{s}_{n}$
\end_inset

, which are distributed in a spatial domain 
\begin_inset Formula $D\subset\mathbb{R}^{2}$
\end_inset

 according to a density 
\begin_inset Formula $f(\bm{s})$
\end_inset

.
 For 
\begin_inset Formula $i=1,\dots,n$
\end_inset

, let 
\begin_inset Formula $y(\bm{s}_{i})$
\end_inset

 and 
\begin_inset Formula $\bm{x}(\bm{s}_{i})$
\end_inset

 denote, respectively, the univariate response and the 
\begin_inset Formula $(p+1)$
\end_inset

-variate vector of covariates measured at location 
\begin_inset Formula $\bm{s}_{i}$
\end_inset

.
 At each observation location 
\begin_inset Formula $\bm{s}_{i}$
\end_inset

, assume that the outcome is related to the covariates by a generalized
 linear model (GLM) where the coefficients 
\begin_inset Formula $\bm{\beta}(\bm{s}_{i})$
\end_inset

 may be spatially varying.
 That is, the distribution of 
\begin_inset Formula $Y$
\end_inset

 conditional on 
\begin_inset Formula $X$
\end_inset

 is: 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
f_{Y|X}(y|x)= & \exp\{y\theta-b(\theta)\}\\
\eta(\bm{s}_{i})= & \bm{x}(\bm{s}_{i})'\bm{\beta}(\bm{s}_{i})\\
\mu(\bm{s}_{i})= & g^{-1}\left\{ \eta(\bm{s}_{i})\right\} 
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
In the context of nonparametric regression, the boundary-effect bias can
 be reduced by local polynomial modeling, usually in the form of a locally
 linear model 
\begin_inset CommandInset citation
LatexCommand citep
key "Fan-1996"

\end_inset

.
 Here, locally linear coefficients are estimated by augmenting the local
 design matrix with covariate-by-location interactions in two dimensions
 as proposed by 
\begin_inset CommandInset citation
LatexCommand citet
key "Wang:2008b"

\end_inset

.
 The augmented local design matrix at location 
\begin_inset Formula $\bm{s}_{i}$
\end_inset

 is 
\begin_inset Formula 
\begin{align}
\bm{Z}(\bm{s}_{i})=\left(\bm{X}\:\: L_{i}\bm{X}\:\: M_{i}\bm{X}\right)
\end{align}

\end_inset


\end_layout

\begin_layout Standard
where 
\begin_inset Formula $\bm{X}$
\end_inset

 is the unaugmented matrix of covariates, 
\begin_inset Formula $L_{i}=\text{diag}\{s_{i'_{1}}-s_{i_{1}}\}$
\end_inset

 and 
\begin_inset Formula $M_{i}=\text{diag}\{s_{i'_{2}}-s_{i_{2}}\}$
\end_inset

 for 
\begin_inset Formula $i'=1,\dots,n$
\end_inset

.
\end_layout

\begin_layout Standard
Now we have that 
\begin_inset Formula $Y(\bm{s}_{i})=\left\{ \bm{Z}(\bm{s}_{i})\right\} _{i}^{T}\bm{\zeta}(\bm{s}_{i})+\varepsilon(\bm{s}_{i})$
\end_inset

, where 
\begin_inset Formula $\left\{ \bm{Z}(\bm{s}_{i})\right\} _{i}^{T}$
\end_inset

 is the 
\begin_inset Formula $i$
\end_inset

th row of the matrix 
\begin_inset Formula $\bm{Z}(\bm{s}_{i})$
\end_inset

 as a row vector, and 
\begin_inset Formula $\bm{\zeta}(\bm{s}_{i})$
\end_inset

 is the vector of local coefficients at location 
\begin_inset Formula $\bm{s}_{i}$
\end_inset

, augmented with the local gradients of the coefficient surfaces in the
 two spatial dimensions, indicated by 
\begin_inset Formula $\nabla_{u}$
\end_inset

 and 
\begin_inset Formula $\nabla_{v}$
\end_inset

:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\bm{\zeta}(\bm{s}_{i})=\left(\bm{\beta}(\bm{s}_{i})^{T}\;\;\nabla_{u}\bm{\beta}(\bm{s}_{i})^{T}\;\;\nabla_{v}\bm{\beta}(\bm{s}_{i})^{T}\right)^{T}
\]

\end_inset


\end_layout

\begin_layout Subsection
Estimation
\end_layout

\begin_layout Standard
The total log-likelihood of the observed data is the sum of the log-likelihood
 of each individual observation: 
\begin_inset Formula 
\begin{align}
\ell\left\{ \bm{\zeta}\right\} = & -(1/2)\sum_{i=1}^{n}\left[\log{\sigma^{2}}+\sigma^{-2}\left\{ y(\bm{s}_{i})-\bm{z}'(\bm{s}_{i})\bm{\zeta}(\bm{s}_{i})\right\} ^{2}\right].\label{eq:coefficients}
\end{align}

\end_inset


\end_layout

\begin_layout Standard
Since there are a total of 
\begin_inset Formula $n\times3(p+1)+1$
\end_inset

 parameters for 
\begin_inset Formula $n$
\end_inset

 observations, the model is not identifiable and it is not possible to directly
 maximize the total likelihood.
 But since the coefficient functions are smooth, the coefficients at location
 
\begin_inset Formula $\bm{s}$
\end_inset

 can approximate the coefficients within some neighborhood of 
\begin_inset Formula $\bm{s}$
\end_inset

, with the quality of the approximation declining as the distance from 
\begin_inset Formula $\bm{s}$
\end_inset

 increases.
\end_layout

\begin_layout Standard
This intuition is formalized by the local likelihood, which is maximized
 at location 
\begin_inset Formula $\bm{s}$
\end_inset

 to estimate the local coefficients 
\begin_inset Formula $\bm{\zeta}(\bm{s})$
\end_inset

: 
\begin_inset Formula 
\begin{align}
\mathcal{L}\left\{ \bm{\zeta}(\bm{s})\right\}  & =\prod_{i=1}^{n}\left\{ \left(2\pi\sigma^{2}\right)^{-1/2}\exp\left[-(1/2)\sigma^{-2}\left\{ y(\bm{s}_{i})-\bm{z}'(\bm{s}_{i})\bm{\zeta}(\bm{s})\right\} ^{2}\right]\right\} ^{K_{h}(\|\bm{s}-\bm{s}_{i}\|)},\label{eq:local-likelihood}
\end{align}

\end_inset


\end_layout

\begin_layout Standard
The weights are computed from a kernel function 
\begin_inset Formula $K_{h}(\cdot)$
\end_inset

 such as the Epanechnikov kernel: 
\begin_inset Formula 
\begin{align}
K_{h}(\|\bm{s}_{i}-\bm{s}_{i'}\|) & =h^{-2}K\left(h^{-1}\|\bm{s}_{i}-\bm{s}_{i'}\|\right)\notag\label{eq:epanechnikov}\\
K(x) & =\begin{cases}
(3/4)(1-x^{2}) & \mbox{ if }x<1,\\
0 & \mbox{ if }x\geq1.
\end{cases}
\end{align}

\end_inset


\end_layout

\begin_layout Standard
Thus, the local log-likelihood function is, up to an additive constant:
 
\begin_inset Formula 
\begin{align}
\ell\left\{ \bm{\zeta}(\bm{s})\right\}  & =-(1/2)\sum_{i=1}^{n}K_{h}(\|\bm{s}-\bm{s}_{i}\|)\left[\log{\sigma^{2}}+\sigma^{-2}\left\{ y(\bm{s}_{i})-\bm{z}'(\bm{s}_{i})\bm{\zeta}(\bm{s})\right\} ^{2}\right].\label{eq:local-log-likelihood}
\end{align}

\end_inset


\end_layout

\begin_layout Standard
Letting 
\begin_inset Formula $\bm{W}(\bm{s})$
\end_inset

 be a diagonal weight matrix where 
\begin_inset Formula $W_{ii}(\bm{s})=K_{h}(\|\bm{s}-\bm{s}_{i}\|)$
\end_inset

, the local likelihood is maximized by weighted least squares: 
\begin_inset Formula 
\begin{align}
\mathcal{S}\left\{ \bm{\zeta}(\bm{s})\right\}  & =(1/2)\left\{ \bm{Y}-\bm{Z}(\bm{s})\bm{\zeta}(\bm{s})\right\} ^{T}\bm{W}(\bm{s})\left\{ \bm{Y}-\bm{Z}(\bm{s})\bm{\zeta}(\bm{s})\right\} ^{T}\notag\label{eq:zeta-hat}\\
\therefore\tilde{\bm{\zeta}}(\bm{s}) & =\left\{ \bm{Z}^{T}(\bm{s})\bm{W}(\bm{s})\bm{Z}(\bm{s})\right\} ^{-1}\bm{Z}^{T}(\bm{s})\bm{W}(\bm{s})\bm{Y}
\end{align}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%    Now define the penalized weighted squared error loss $Q$:
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%    
\backslash
begin{equation*}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%        Q 
\backslash
left
\backslash
{ 
\backslash
bm{
\backslash
zeta} (
\backslash
bm{s}) 
\backslash
right
\backslash
} = (1/2) 
\backslash
left
\backslash
{ 
\backslash
bm{Y} - 
\backslash
bm{Z}(
\backslash
bm{s}) 
\backslash
bm{
\backslash
zeta} (
\backslash
bm{s}) 
\backslash
right
\backslash
}^T 
\backslash
bm{W}(
\backslash
bm{s}) 
\backslash
left
\backslash
{ 
\backslash
bm{Y} - 
\backslash
bm{Z}(
\backslash
bm{s}) 
\backslash
bm{
\backslash
zeta} (
\backslash
bm{s}) 
\backslash
right
\backslash
}^T + 
\backslash
sum_{j=1}^p 
\backslash
phi_j(
\backslash
bm{s}) 
\backslash
| 
\backslash
bm{
\backslash
zeta}(
\backslash
bm{s}) 
\backslash
|.
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%    
\backslash
end{equation*}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%    From (
\backslash
ref{eq:local-log-likelihood}), the maximum local likelihood estimate $
\backslash
hat{
\backslash
sigma}_i^2$ is:	 
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%    
\backslash
begin{align}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%        
\backslash
hat{
\backslash
sigma}^2(
\backslash
bm{s}) = 
\backslash
left
\backslash
{ 
\backslash
sum 
\backslash
limits_{i=1}^{n} K_h( 
\backslash
| 
\backslash
bm{s} - 
\backslash
bm{s}_i 
\backslash
| ) 
\backslash
right
\backslash
}^{-1} 
\backslash
sum 
\backslash
limits_{i=1}^n K_h( 
\backslash
| 
\backslash
bm{s} - 
\backslash
bm{s}_i 
\backslash
| ) 
\backslash
left
\backslash
{ y(
\backslash
bm{s}_i) - 
\backslash
bm{z}'(
\backslash
bm{s}_i) 
\backslash
hat{
\backslash
bm{
\backslash
zeta}}(
\backslash
bm{s}) 
\backslash
right
\backslash
}^2
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%    
\backslash
end{align}
\end_layout

\end_inset


\end_layout

\begin_layout Section
Local variable selection and parameter estimation 
\begin_inset CommandInset label
LatexCommand label
name "section:model-selection"

\end_inset


\end_layout

\begin_layout Subsection
Local variable selection
\end_layout

\begin_layout Standard
Local adaptive grouped regularization (LAGR) is explored as a method of
 local variable selection and coefficient estimation in SVCR models.
 The proposed LAGR penalty is an adaptive 
\begin_inset Formula $\ell_{1}$
\end_inset

 penalty akin to the adaptive group lasso 
\begin_inset CommandInset citation
LatexCommand citep
key "Wang-Leng-2008,Zou:2006"

\end_inset

.
\end_layout

\begin_layout Standard
Grouped variables are selected together for inclusion in the model.
 Each group in a LAGR model consists of one covariate and its gradients
 on the two dimensions of spatial location.
 That is, 
\begin_inset Formula $\bm{\zeta}_{j}(\bm{s})=\left(\beta_{j}(\bm{s})\;\;\;\nabla_{u}\beta_{j}(\bm{s})\;\;\;\nabla_{v}\beta_{j}(\bm{s})\right)^{T}$
\end_inset

 for 
\begin_inset Formula $j=1,\dots,p$
\end_inset

.
\end_layout

\begin_layout Standard
The objective function for the LAGR at location 
\begin_inset Formula $\bm{s}$
\end_inset

 is the penalized local sum of squares: 
\begin_inset Formula 
\begin{align}
Q\{\bm{\zeta}(\bm{s})\} & =\mathcal{S}\left\{ \bm{\zeta}(\bm{s})\right\} +\mathcal{J}\{\bm{\zeta}(\bm{s})\}\notag\label{eq:adaptive-lasso-WLS}\\
 & =(1/2)\left\{ \bm{Y}-\bm{Z}(\bm{s})\bm{\zeta}(\bm{s})\right\} ^{T}\bm{W}(\bm{s})\left\{ \bm{Y}-\bm{Z}(\bm{s})\bm{\zeta}(\bm{s})\right\} ^{T}+\sum_{j=1}^{p}\phi_{j}(\bm{s})\|\bm{\zeta}_{j}(\bm{s})\|
\end{align}

\end_inset


\end_layout

\begin_layout Standard
which is the sum of the weighted sum of squares 
\begin_inset Formula $\mathcal{S}\left\{ \bm{\zeta}(\bm{s})\right\} $
\end_inset

 and the LAGR penalty 
\begin_inset Formula $\mathcal{J}\{\bm{\zeta}(\bm{s})\}$
\end_inset

.
\end_layout

\begin_layout Standard
The LAGR penalty for the 
\begin_inset Formula $j$
\end_inset

th group of coefficients 
\begin_inset Formula $\bm{\zeta}_{j}(\bm{s})$
\end_inset

 at location 
\begin_inset Formula $\bm{s}$
\end_inset

 is 
\begin_inset Formula $\phi_{j}(\bm{s})=\lambda_{n}(\bm{s})\|\tilde{\bm{\zeta}}_{j}(\bm{s})\|^{-\gamma}$
\end_inset

, where 
\begin_inset Formula $\lambda_{n}(\bm{s})>0$
\end_inset

 is a the local tuning parameter applied to all coefficients at location
 
\begin_inset Formula $\bm{s}$
\end_inset

 and 
\begin_inset Formula $\tilde{\bm{\zeta}}_{j}(\bm{s})$
\end_inset

 is the vector of unpenalized local coefficients from (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:zeta-hat"

\end_inset

).
\end_layout

\begin_layout Subsection
Computation
\end_layout

\begin_layout Subsubsection
Tuning parameter selection
\end_layout

\begin_layout Standard
Implementing LAGR requires the selection of local tuning parameters.
 The criteria commonly used for selecting tuning parameters in lasso-type
 models are appropriate here, including GCV 
\begin_inset CommandInset citation
LatexCommand citep
key "Wahba:1990"

\end_inset

, Cp 
\begin_inset CommandInset citation
LatexCommand citep
key "Mallows-1973"

\end_inset

, AIC 
\begin_inset CommandInset citation
LatexCommand citep
key "Akaike-1973"

\end_inset

, and BIC 
\begin_inset CommandInset citation
LatexCommand citep
key "Schwarz-1978"

\end_inset

.
 All of the examples and simulations presented herein used the corrected
 AIC (AICc) 
\begin_inset CommandInset citation
LatexCommand citep
key "Hurvich-1998"

\end_inset

 for tuning parameter selection:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\text{AIC}_{\text{c}}(\bm{s})=\hat{\sigma}^{-2}(\bm{s})\|\bm{Y}-\bm{Z}(\bm{s})\hat{\bm{\zeta}}(\bm{s})\|^{2}+2df+2\frac{df(df+1)}{\sum_{i=1}^{n}K_{h}(\|\bm{s}-\bm{s}_{i}\|)-df-1}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
where 
\begin_inset Formula $df$
\end_inset

 is the degrees of freedom as defined in 
\begin_inset CommandInset citation
LatexCommand citet
key "Yuan-Lin-2006"

\end_inset

:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
df=\sum_{j=1}^{p}I\left\{ \|\hat{\bm{\zeta}}_{j}(\bm{s})\|\right\} +2\sum_{j=1}^{p}\frac{\|\hat{\bm{\zeta}}_{j}(\bm{s})\|}{\|\tilde{\bm{\zeta}}_{j}(\bm{s})\|}
\end{equation}

\end_inset


\end_layout

\begin_layout Section
References
\end_layout

\begin_layout Standard
 
\begin_inset CommandInset bibtex
LatexCommand bibtex
bibfiles "../../references/gwr"
options "chicago"

\end_inset


\end_layout

\end_body
\end_document
